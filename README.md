# <img src="https://i.ibb.co/N2tW1dB2/Screenshot-2025-04-12-11-48-26-043-com-chrome-dev-edit-removebg-preview.png" alt="Haibit Logo" width="50" height="50" style="vertical-align: middle; margin-right: 10px;"> Haibit

*Tu wiki libre, minimalista y flexible.*

[![Website Status](https://img.shields.io/website?url=https%3A%2F%2Fthehaibit.com&label=thehaibit.com&style=flat-square)](https://thehaibit.com/)
[![Licencia: MIT](https://img.shields.io/badge/licencia-MIT-green?style=flat-square)](LICENSE)
[![Estado v4 (Principal): Prototipo](https://img.shields.io/badge/v4_(Principal)-Prototipo-blue?style=flat-square)](/)
[![Estado v5 (Comunidades): Prototipo](https://img.shields.io/badge/v5_(Comunidades)-Prototipo-blueviolet?style=flat-square)](/comunidades)


---

**Haibit** es una plataforma wiki abierta y experimental con un enfoque minimalista y m√≥vil primero. Actualmente existen dos versiones principales en desarrollo:

1.  **Haibit Principal (v4):** Una versi√≥n m√°s simple y directa para crear p√°ginas wiki individuales. **Disponible en: [thehaibit.com](https://thehaibit.com/)**
2.  **Haibit Comunidades (v5 - "SuBits"):** Una versi√≥n m√°s avanzada que introduce comunidades tem√°ticas (SuBits) con su propia estructura de p√°ginas, secciones y subsecciones. **Disponible en: [thehaibit.com/comunidades](https://thehaibit.com/comunidades)**

Ambas versiones permiten crear contenido en Markdown o HTML Mixto sin necesidad de registro.

## üöÄ Demos y Capturas

* **Demo Principal (v4):** üîó **[https://thehaibit.com/](https://thehaibit.com/)**
* **Demo Comunidades (v5):** üîó **[https://thehaibit.com/comunidades](https://thehaibit.com/comunidades)**

<p align="center">
  <img src="https://i.ibb.co/4RtWm3Q9/Screenshot-2025-04-12-11-46-28-292-com-chrome-dev-edit.jpg" alt="Haibit v4/v5 Interface" width="700">
  <br>
  <em>Interfaz de ejemplo de Haibit</em>
</p>

---

## ‚ú® Caracter√≠sticas Clave

* **v4 (Principal):** Creaci√≥n simple de p√°ginas wiki, PFP opcional, editor CodeMirror, Markdown/HTML, vista previa, b√∫squeda b√°sica.
* **v5 (Comunidades):** Todo lo de v4 M√ÅS:
    * **SuBits:** Creaci√≥n y navegaci√≥n de comunidades tem√°ticas.
    * **Estructura Jer√°rquica:** Organizaci√≥n de p√°ginas por secciones/subsecciones dentro de un SuBit.
    * **Navegaci√≥n SPA:** Uso de rutas hash (`#/...`) para navegar dentro de la secci√≥n de comunidades.
    * **Personalizaci√≥n de SuBit:** Nombre, descripci√≥n y logo para cada comunidad.

## üí° Filosof√≠a del Proyecto

*(Igual que antes: Libre/Abierto, Minimalista, Flexible, Sin Fricci√≥n, M√≥vil Primero)*

---

## üõ†Ô∏è Tecnolog√≠as Utilizadas

*(Igual que antes: HTML, Tailwind (Play CDN), Vanilla JS, Supabase, CodeMirror, Marked, DOMPurify, Prism, Lucide)*

---

## üèÅ C√≥mo Empezar (Ejecutar Localmente)

Este repositorio ahora contiene ambas versiones:

* **v4:** Se encuentra en el archivo `index.html` de la ra√≠z.
* **v5:** Se encuentra en el archivo `comunidades/index.html`.

Para ejecutar **ambas** localmente (necesitar√°s configurar Supabase una sola vez):

1.  **Clonar:** `git clone https://github.com/espcdev/Haibit-Rewritten.git && cd Haibit-Rewritten`
2.  **Cuenta y Proyecto Supabase:** Crea un proyecto en [Supabase.io](https://supabase.io/) y obt√©n tu **URL** y **Clave An√≥nima (`anon key`)**.
3.  **Configurar Base de Datos Supabase:**
    <details>
    <summary><strong>SQL para Base de Datos (Necesario para v5, opcionalmente adaptable para v4)</strong></summary>

    ```sql
    /* --- Tablas y Pol√≠ticas para v5 (Comunidades) --- */

    -- Crear tabla 'subits'
    CREATE TABLE subits ( id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY, created_at TIMESTAMPTZ DEFAULT NOW() NOT NULL, slug TEXT NOT NULL UNIQUE CHECK (slug ~ '^[a-z0-9-]+$' AND char_length(slug) > 2), name TEXT NOT NULL CHECK (char_length(name) > 0), description TEXT, logo_url TEXT, creator_pfp_url TEXT );
    ALTER TABLE subits ENABLE ROW LEVEL SECURITY;
    DROP POLICY IF EXISTS "Allow public read access" ON subits; CREATE POLICY "Allow public read access" ON subits FOR SELECT USING (true);
    DROP POLICY IF EXISTS "Allow public insert access" ON subits; CREATE POLICY "Allow public insert access" ON subits FOR INSERT WITH CHECK (true);

    -- Crear tabla 'wiki_pages'
    CREATE TABLE wiki_pages ( id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY, created_at TIMESTAMPTZ DEFAULT NOW() NOT NULL, last_updated_at TIMESTAMPTZ DEFAULT NOW() NOT NULL, subit_id BIGINT NOT NULL REFERENCES subits(id) ON DELETE CASCADE, title TEXT NOT NULL CHECK (char_length(title) > 0), slug TEXT NOT NULL CHECK (slug ~ '^[a-z0-9-]+$' AND char_length(slug) > 0), content TEXT NOT NULL CHECK (char_length(content) > 20), content_type TEXT DEFAULT 'markdown' NOT NULL, creator_pfp_url TEXT, section_key TEXT CHECK (section_key IS NULL OR section_key ~ '^[a-z0-9-]+$'), subsection_key TEXT CHECK (subsection_key IS NULL OR subsection_key ~ '^[a-z0-9-]+$'), search_vector TSVECTOR, CONSTRAINT wiki_pages_subit_id_slug_key UNIQUE (subit_id, slug) );
    ALTER TABLE wiki_pages ENABLE ROW LEVEL SECURITY;
    DROP POLICY IF EXISTS "Allow public read access" ON wiki_pages; CREATE POLICY "Allow public read access" ON wiki_pages FOR SELECT USING (true);
    DROP POLICY IF EXISTS "Allow public insert access" ON wiki_pages; CREATE POLICY "Allow public insert access" ON wiki_pages FOR INSERT WITH CHECK ( char_length(title) > 0 AND char_length(content) > 20 );

    -- Funci√≥n y Trigger para last_updated_at
    CREATE OR REPLACE FUNCTION update_last_updated_at_column() RETURNS TRIGGER AS $$BEGIN NEW.last_updated_at = NOW(); RETURN NEW; END;$$ LANGUAGE plpgsql;
    DROP TRIGGER IF EXISTS update_wiki_pages_last_updated_at ON wiki_pages; CREATE TRIGGER update_wiki_pages_last_updated_at BEFORE UPDATE ON wiki_pages FOR EACH ROW EXECUTE FUNCTION update_last_updated_at_column();

    -- √çndices opcionales
    CREATE INDEX IF NOT EXISTS idx_wiki_pages_subit_id ON wiki_pages(subit_id); CREATE INDEX IF NOT EXISTS idx_wiki_pages_slug ON wiki_pages(slug); CREATE INDEX IF NOT EXISTS idx_wiki_pages_section_key ON wiki_pages(section_key);

    /* --- Tabla para v4 (si quieres mantenerla separada) --- */
    /* Si quieres usar la misma DB para v4, podr√≠as crear una tabla 'legacy_wikis' similar a la 'wikis' original de v4, o adaptar el c√≥digo v4 para usar 'wiki_pages' con un subit_id especial (ej: null o 0), lo cual es m√°s complejo. */
    /* Lo m√°s simple para probar localmente v4 puede ser usar su SQL original en un proyecto Supabase SEPARADO o comentar/ignorar la carga de datos en v4 si solo quieres ver la UI. */

    ```
    *Ejecuta el SQL relevante en el `SQL Editor` de tu proyecto Supabase.*
    </details>

4.  **Configurar Supabase Storage:**
    <details>
    <summary><strong>Pasos y Pol√≠ticas de Storage (para PFP en ambas versiones)</strong></summary>

    1.  Ve a `Storage` en Supabase.
    2.  Crea un bucket llamado `pfps`.
    3.  **Marca la casilla `Make this bucket public`**.
    4.  Ve a `Policies` y crea/verifica estas pol√≠ticas:

        * **Lectura P√∫blica:**
            ```sql
            CREATE POLICY "Allow Public Read Access on pfps" ON storage.objects FOR SELECT USING ( bucket_id = 'pfps' );
            ```
        * **Subida P√∫blica (Corregida):**
            ```sql
            CREATE POLICY "Allow Public Uploads to pfps" ON storage.objects FOR INSERT WITH CHECK ( (bucket_id = 'pfps') AND (storage.extension(name) IN ('png','jpg','jpeg','gif','webp')) );
            ```
    </details>

5.  **Configurar Claves API:**
    * Abre **ambos** archivos (`index.html` y `comunidades/index.html`).
    * En **cada uno**, busca y reemplaza `'TU_SUPABASE_URL_AQUI'` y `'TU_SUPABASE_ANON_KEY_AQUI'` con tus credenciales reales.
    * **‚ö†Ô∏è ¬°No subas tus claves reales a GitHub!**

6.  **Abrir en Navegador:**
    * Para ver v4: Abre el archivo `index.html` de la ra√≠z.
    * Para ver v5: Abre el archivo `comunidades/index.html`. *(Nota: La navegaci√≥n interna de v5 con `#` funcionar√° correctamente)*.

---

## ‚ö†Ô∏è Limitaciones y Advertencias (Ambas Versiones Prototipo)

* **Prototipo:** Ambas v4 y v5 son prototipos funcionales.
* **Single File + Play CDN:** **No recomendado para producci√≥n**. Se necesita un proceso de build.
* **üö® Seguridad HTML/`<style>` (v4 y v5):** Permitir HTML y `<style>` tiene **riesgos de seguridad inherentes**.
* **Almacenamiento P√∫blico/An√≥nimo:** La subida de PFPs es an√≥nima. Evaluar riesgos.
* **Funcionalidad Pendiente:** Edici√≥n/borrado, historial, moderaci√≥n, etc., no implementados.

---

## üîÆ Futuro / Roadmap

*(Similar a antes, pero quiz√°s enfocado en unificar o decidir la direcci√≥n principal)*

* [ ] Unificar codebase o mantener ramas separadas con build.
* [ ] Implementar CRUD completo (Editar/Borrar) para p√°ginas y SuBits.
* [ ] Autenticaci√≥n de Usuarios (Supabase Auth).
* [ ] Refinar seguridad del modo HTML o alternativas.
* [ ] B√∫squeda avanzada (Full-Text Search).
* [ ] Historial de versiones.
* [ ] Moderaci√≥n / Reportes.
* [ ] Pruebas automatizadas.

---

## ü§ù Contribuir

¬°Las contribuciones son bienvenidas! Si deseas ayudar a mejorar Haibit:

1.  **Haz un Fork** del repositorio.
2.  **Crea una nueva rama** (`git checkout -b feature/mejora` o `fix/bug`).
3.  **Realiza tus cambios** y haz commit (`git commit -am 'feat: Describe tu cambio'`).
4.  **Haz Push** a tu rama (`git push origin feature/mejora`).
5.  **Abre un Pull Request** explicando tus cambios.

Tambi√©n puedes abrir un [Issue](https://github.com/espcdev/Haibit-Rewritten/issues) para reportar bugs o sugerir ideas.

---

## üìú Licencia

Este proyecto est√° bajo la Licencia MIT. Ver el archivo `LICENSE` para m√°s detalles.

---

*Hecho con ‚ù§Ô∏è por **espcdev***
