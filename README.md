# <img src="https://i.ibb.co/N2tW1dB2/Screenshot-2025-04-12-11-48-26-043-com-chrome-dev-edit-removebg-preview.png" alt="Haibit Logo" width="50" height="50" style="vertical-align: middle; margin-right: 10px;"> Haibit v4

*Tu wiki libre, minimalista y flexible.*

[![Estado: Prototipo v4](https://img.shields.io/badge/estado-prototipo_v4-blue?style=flat-square)](https://github.com/espcdev/Haibit-Rewritten) [![Website Status](https://img.shields.io/website?url=https%3A%2F%2Fthehaibit.com&label=thehaibit.com&style=flat-square)](https://thehaibit.com/)
[![Licencia: MIT](https://img.shields.io/badge/licencia-MIT-green?style=flat-square)](LICENSE) ---

**Haibit** es una plataforma wiki abierta y experimental con un dise√±o minimalista y m√≥vil primero. Explora la versi√≥n actual en **[thehaibit.com](https://thehaibit.com/)**.

El objetivo es permitir a cualquier usuario crear y compartir conocimiento f√°cilmente, ofreciendo flexibilidad en el formato (Markdown y HTML Mixto) sin requerir registro. Esta versi√≥n v4 es un prototipo funcional.

## üöÄ Demo en Vivo y Captura

Visita la demo desplegada para probar Haibit:

üîó **[https://thehaibit.com/](https://thehaibit.com/)**

<p align="center">
  <img src="https://i.ibb.co/4RtWm3Q9/Screenshot-2025-04-12-11-46-28-292-com-chrome-dev-edit.jpg" alt="Haibit v4 Interface" width="700">
  <br>
  <em>Interfaz principal de Haibit v4</em>
</p>

---

## üí° Filosof√≠a del Proyecto

* **Libre y Abierto:** Acceso sin barreras para crear y consultar informaci√≥n.
* **Minimalista:** Interfaz limpia y enfocada en el contenido.
* **Flexible:** Soporte para m√∫ltiples formatos de contenido (Markdown y HTML).
* **Sin Fricci√≥n:** Experiencia de usuario sencilla, sin necesidad de cuentas.
* **M√≥vil Primero:** Dise√±o optimizado para uso en dispositivos m√≥viles.

---

## ‚ú® Caracter√≠sticas Principales (v4)

* **Editor Dual:** Soporte para **Markdown** y **HTML Mixto** con selector de formato.
* **Vista Previa en Vivo:** Renderizado instant√°neo del contenido con espaciado corregido.
* **Editor Avanzado (CodeMirror):** Resaltado de sintaxis, n√∫meros de l√≠nea, l√≠nea activa, placeholder, barra de herramientas y atajos b√°sicos.
* **Renderizado Consistente:** Estilos CSS dedicados para una visualizaci√≥n clara del contenido final.
* **Resaltado de C√≥digo (Prism.js):** Formato autom√°tico para bloques de c√≥digo.
* **Sanitizaci√≥n HTML (DOMPurify):** Protecci√≥n contra XSS (configurado para permitir `<style>` en modo HTML, ver advertencias).
* **PFP Personalizada:** Asociaci√≥n opcional de imagen de perfil (v√≠a Supabase Storage).
* **Dise√±o Responsivo:** Adaptado a diferentes tama√±os de pantalla.
* **B√∫squeda y Paginaci√≥n:** Filtrado b√°sico y carga progresiva de wikis.

## üõ†Ô∏è Tecnolog√≠as Utilizadas

* **Frontend:**
    * üåê **HTML5** y **CSS3**: Estructura y estilos base.
    * üé® **Tailwind CSS (Play CDN):** Framework CSS utility-first para desarrollo r√°pido (versi√≥n demo).
    * üìú **Vanilla JavaScript (ESM):** L√≥gica de la interfaz y funcionalidad.
* **Backend & Base de Datos:**
    * ‚òÅÔ∏è **Supabase:** Plataforma BaaS open source.
        * *PostgreSQL Database:* Almacenamiento principal de wikis.
        * *Supabase Storage:* Almacenamiento de im√°genes PFP. Elegido por su facilidad de integraci√≥n y generoso plan gratuito.
* **Librer√≠as Clave:**
    * ‚úçÔ∏è **CodeMirror:** Editor de texto robusto y configurable.
    * üîÑ **Marked.js:** Parser r√°pido de Markdown a HTML.
    * üîí **DOMPurify:** Sanitizador de HTML esencial para seguridad.
    * üí° **Prism.js:** Resaltado de sintaxis ligero y extensible.
* **Iconos:** ‚ú® **Lucide Icons** (SVGs embebidos)

---

## üèÅ C√≥mo Empezar (Ejecutar Localmente)

Sigue estos pasos para configurar y ejecutar Haibit v4 en tu m√°quina:

1.  **Clonar Repositorio:**
    ```bash
    git clone [https://github.com/espcdev/Haibit-Rewritten.git](https://github.com/espcdev/Haibit-Rewritten.git)
    cd TU_REPOSITORIO
    ```
    
2.  **Cuenta y Proyecto Supabase:**
    * Crea una cuenta en [Supabase.io](https://supabase.io/).
    * Crea un nuevo proyecto y obt√©n tu **URL del Proyecto** y **Clave An√≥nima (`anon key`)**.

3.  **Configurar Base de Datos Supabase:**
    <details>
    <summary><strong>Haz clic para ver y copiar el SQL de la Base de Datos</strong></summary>

    ```sql
    -- Crear tabla wikis (si no existe)
    CREATE TABLE IF NOT EXISTS wikis (
      id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
      created_at TIMESTAMPTZ DEFAULT NOW() NOT NULL,
      last_updated_at TIMESTAMPTZ DEFAULT NOW() NOT NULL,
      title TEXT NOT NULL CHECK (char_length(title) > 0),
      content TEXT NOT NULL CHECK (char_length(content) > 20), -- Check m√≠nimo
      content_type TEXT DEFAULT 'markdown' NOT NULL, -- markdown o html
      creator_pfp_url TEXT, -- URL p√∫blica de Supabase Storage
      search_vector TSVECTOR -- Opcional para b√∫squeda avanzada
    );

    -- Habilitar Row Level Security (¬°MUY IMPORTANTE!)
    ALTER TABLE wikis ENABLE ROW LEVEL SECURITY;

    -- Borrar pol√≠ticas antiguas si existen (para evitar conflictos)
    DROP POLICY IF EXISTS "Allow public read access" ON wikis;
    DROP POLICY IF EXISTS "Allow public insert access" ON wikis;

    -- Pol√≠tica: Cualquiera puede LEER todas las wikis
    CREATE POLICY "Allow public read access" ON wikis
      FOR SELECT USING (true);

    -- Pol√≠tica: Cualquiera puede INSERTAR una nueva wiki (con validaciones)
    CREATE POLICY "Allow public insert access" ON wikis
      FOR INSERT WITH CHECK (
        char_length(title) > 0 AND
        char_length(content) > 20 -- Check m√≠nimo de contenido
      );

    -- Funci√≥n para actualizar 'last_updated_at' (si no existe)
    CREATE OR REPLACE FUNCTION update_last_updated_at_column()
    RETURNS TRIGGER AS $$
    BEGIN
      NEW.last_updated_at = NOW();
      RETURN NEW;
    END;
    $$ LANGUAGE plpgsql;

    -- Trigger que usa la funci√≥n (si no existe)
    DROP TRIGGER IF EXISTS update_wikis_last_updated_at ON wikis;
    CREATE TRIGGER update_wikis_last_updated_at
    BEFORE UPDATE ON wikis
    FOR EACH ROW
    EXECUTE FUNCTION update_last_updated_at_column();
    ```
    *Ejecuta este SQL en el `SQL Editor` de tu proyecto Supabase.*
    </details>

4.  **Configurar Supabase Storage:**
    <details>
    <summary><strong>Haz clic para ver los pasos y pol√≠ticas de Storage</strong></summary>

    1.  Ve a `Storage` en tu dashboard de Supabase.
    2.  Crea un bucket llamado `pfps`.
    3.  **Importante:** Marca la casilla `Make this bucket public`.
    4.  Ve a `Policies` bajo `Storage` y crea/verifica estas pol√≠ticas (ejecut√°ndolas en SQL Editor o desde la UI):

        * **Lectura P√∫blica:**
            ```sql
            CREATE POLICY "Allow Public Read Access on pfps" ON storage.objects FOR SELECT USING ( bucket_id = 'pfps' );
            ```
        * **Subida P√∫blica (Corregida):**
            ```sql
            CREATE POLICY "Allow Public Uploads to pfps" ON storage.objects FOR INSERT WITH CHECK ( (bucket_id = 'pfps') AND (storage.extension(name) IN ('png','jpg','jpeg','gif','webp')) );
            ```
            *(La validaci√≥n de tama√±o se realiza en el cliente JS).*
    </details>

5.  **Configurar Claves API:**
    * Abre el archivo `index.html` (o el archivo principal).
    * Busca y reemplaza `'TU_SUPABASE_URL_AQUI'` y `'TU_SUPABASE_ANON_KEY_AQUI'` con tus credenciales reales de Supabase.
    * **Importante:** No compartas ni subas tus claves reales a repositorios p√∫blicos.

6.  **Abrir en Navegador:** Abre el archivo HTML principal en tu navegador web.

---

## üìñ C√≥mo Usar la Aplicaci√≥n

* **Navegar/Buscar:** Explora las wikis en la p√°gina principal. Usa la barra de b√∫squeda para filtrar o el bot√≥n "Cargar M√°s" para ver m√°s entradas.
* **Establecer PFP:** Haz clic en el c√≠rculo (üë§) en la esquina superior izquierda para subir una imagen. Se usar√° al guardar nuevas wikis.
* **Crear/Editar:**
    * Haz clic en "+ New".
    * Selecciona el formato deseado (Markdown o HTML).
    * Introduce un t√≠tulo.
    * Escribe el contenido en el editor CodeMirror. Puedes usar los botones de la barra de herramientas para aplicar formato r√°pidamente (especialmente √∫til en Markdown).
    * La vista previa se actualizar√° autom√°ticamente a la derecha.
    * Haz clic en "Guardar Wiki" cuando termines.
* **Ver Detalle:** Haz clic en cualquier tarjeta de wiki para abrir la vista completa.

---

## ‚ö†Ô∏è Limitaciones y Advertencias Importantes

* **Naturaleza de Prototipo:** Haibit v4 es un prototipo. Funciona, pero puede tener errores y carece de muchas caracter√≠sticas de una aplicaci√≥n de producci√≥n.
* **Tecnolog√≠a de Demo (Play CDN):** La versi√≥n actual usa Tailwind Play CDN. **No es recomendable para producci√≥n** debido a su impacto en el rendimiento. Una versi√≥n futura deber√≠a usar un proceso de build.
* **üö® Seguridad del Modo HTML:** El modo "HTML" permite la inserci√≥n de etiquetas `<style>`. Aunque DOMPurify intenta sanitizar, **esto representa un riesgo de seguridad inherente** si la plataforma se usara p√∫blicamente con contenido no confiable. La configuraci√≥n actual est√° optimizada para pruebas de funcionalidad.
* **Almacenamiento P√∫blico/An√≥nimo:** Las PFPs se suben an√≥nimamente a un bucket p√∫blico para simplificar (sin login). Esto tiene implicaciones de seguridad a considerar en un despliegue real.
* **Funcionalidad Pendiente:** No incluye edici√≥n, borrado, historial, moderaci√≥n avanzada, etc.

---

## üîÆ Futuro / Roadmap

El desarrollo futuro podr√≠a incluir:

* [ ] Transici√≥n a un framework moderno (SvelteKit, Next.js, Astro) con proceso de build.
* [ ] Implementaci√≥n de CRUD completo (Editar/Borrar).
* [ ] Sistema opcional de autenticaci√≥n (Supabase Auth).
* [ ] Revisi√≥n profunda de la seguridad del modo HTML o alternativas (CSS restringido, temas).
* [ ] B√∫squeda avanzada (Supabase Full-Text Search).
* [ ] Historial de versiones / diffs.
* [ ] Sistema de moderaci√≥n o reportes.
* [ ] Pruebas automatizadas.

---

## ü§ù Contribuir

¬°Las contribuciones son bienvenidas! Si deseas ayudar a mejorar Haibit:

1.  **Haz un Fork** del repositorio.
2.  **Crea una nueva rama** para tu funcionalidad o correcci√≥n:
    `git checkout -b feature/nombre-descriptivo` o `git checkout -b fix/error-especifico`.
3.  **Realiza tus cambios** y haz commit:
    `git commit -am 'feat: A√±ade [funcionalidad X]'` o `git commit -am 'fix: Corrige [error Y]'`.
4.  **Haz Push** a tu rama:
    `git push origin feature/nombre-descriptivo`.
5.  **Abre un Pull Request** en el repositorio original, explicando claramente tus cambios.

Tambi√©n puedes abrir un [Issue](https://github.com/espcdev/Haibit-Rewritten/issues) para reportar bugs o sugerir ideas. ---

## üìú Licencia

Este proyecto est√° bajo la Licencia MIT. Ver el archivo `LICENSE` para m√°s detalles.

---

*Hecho con ‚ù§Ô∏è por **espcdev***
